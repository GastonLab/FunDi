Copyright 2009, 2010 Daniel Gaston, Andrew Roger Lab
This code is copyrighted under the GNU General Public License Version 3.0

       This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.


FunDi version 1.2. Any questions, comments, feedback, or bug reports
should be directed to daniel.gaston@dal.ca

---------------------------------------------------------------------------------------------------------------
INSTALLATION
---------------------------------------------------------------------------------------------------------------
~:>unzip qmmraxml.zip
~:>cd qmmraxml
~:>make
~:>cd ..

move the resulting qmmraxmlHPC executable file to somewhere in your path

Place the Perl modules (*.pm) files somewhere in your perl module path/library, or in your working directory.
Place the FunDi.pl script somewhere in your path, or within the working directory 
----------------------------------------------------------------------------------------------------------------

---------------------------------------------------------------------------------------------------------------
FAQ and Problems
---------------------------------------------------------------------------------------------------------------
1. FunDi gives an error of sh: l: puzzle: not found or similar

The instructions above assume you are using qmmRAxML to estimate the site-likelihoods. However, FunDi can use other programs such as RAxML,
Tree-Puzzle, etc to estimate these sitelikelihoods. You must be sure that if you are using one of these alternative programs
(a full list is available with the -h option) that the program is installed and executable from the system PATH.

---------------------------------------------------------------------------------------------------------------
USE
---------------------------------------------------------------------------------------------------------------
FunDi.pl can be run with a Phylip like interactive interface by executing FunDi.pl or it can be given
command line options. To see all available options run FunDi.pl with the -h option for help.

FunDi currently requires pre-defined subfamilies for functional divergence analysis. These definitions should
be places in the subtree.def file. To define subfamilies list the names of all members of each subfamily, one
subfamily per line as in the example distributed (gapdh_dubtree.def).

The 9componentsDirichlet_* files are the Dirichlet mixture models file and must be in your working directory.

FunDi can be executed with no arguments provided, which starts an interactive phylip-style menu-mode. Or
it can be executed with input command line arguments. The -h option brings up a small help notice.

It is recommended to use QmmRAxML for the backing phylogenetic maximum-likelihood calculations. This is
based on our publication (see below) as well as personal experience with additional datasets.

FunDi by default works with phylip formatted alignment files. Some rudimentary checking (by file format extension) is
done to detect and convert fasta alignments to phylip.


The GAPDH example (chloroplast GapA versus cytosolic GapC) is provided. The command-line used to produce
the provided results was:

perl FunDi.pl -a GAPDH_alignment.phy -o gapdh_subtree -m LG -s gapdh_subtree.def -P qmmraxml -r 4 -t gapdh.tre


---------------------------------------------------------------------------------------------------------------

---------------------------------------------------------------------------------------------------------------
Perl Modules
---------------------------------------------------------------------------------------------------------------
FunDi comes bundled with a variety of Perl Modules which act as libraries for calling external likelihood 
calculation programs and for parsing their outputs appropriately.


---------------------------------------------------------------------------------------------------------------
RESULTS
---------------------------------------------------------------------------------------------------------------
FunDi currently outputs many results file, the majority of which are intermediate files generated by the 
"backend" phylogenetic inference packages used (RAxML, QmmRAxML, FastTree). The most important results file is
called FunDi_Posterior_Scores.txt. This contains the Posterior Probabilities of functional divergence (P(FD)).
Note that numbering is 0-based.

While no cut-off has been defined for what constitutes functional divergence, any site with a P(FD) of greater
than 0.5 is being at least slightly better modeled by the Independence (Functional Divergence) component of the
mixture model. In my own testing I have found sites known to be biologically divergent (for example in GAPDH) with
scores of just over 0.5 all the way to 0.99. FunDi scores are sensitive to taxonomic sampling. The better and more 
diverse the sampling in your input dataset, the better the performance.


---------------------------------------------------------------------------------------------------------------
Citation
---------------------------------------------------------------------------------------------------------------
If you use FunDi please cite the relevant paper:

Gaston D, Susko E, Roger AJ (2011) FunDi: A Phylogenetic Mixture Model for the Identification of Functionally 
Divergent Protein Residues. Bioinformatics  Oct 1;27(19):2655-63 

